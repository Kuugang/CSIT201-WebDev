<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CaTalk Forum</title>
    <link rel="icon" type="image/gif" href="https://media.tenor.com/Vy5sPxwNWxAAAAAi/sebusun-mocha.gif" />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css"> 
    
    <script id = "posts" type = "text/x-handlebars-template">
        {{#each data}}
            {{#if post}}
            <div class="post-item relative w-full shadow-md border rounded border-gray-200 mb-2 px-5 pb-1 pt-3 {{# if postOwner}} bg-blue-300 {{else}} bg-cyan-50{{/if}} hover:border hover:border-black cursor-pointer transition break-words overflow-hidden" id="{{id}}">
                {{#if isPinned}}
                    <!-- <i class="material-icons text-2xl z-10 absolute -top-0 -right-0 rotate-[30deg] text-red-600">push_pin</i> -->
                    <img class = "z-10 absolute top-2 right-2 text-red-600" width="25" height="25" src="https://img.icons8.com/ios-filled/50/000000/pin--v1.png" alt="pin--v1"/>
                {{/if}}

                <div class = "p-2 border bg-[#E3F2F1] relative">
                    {{#if user}}
                        <h1 class="font-extralight text-sm inline">Posted by:</h1>
                        <img class="w-1/12 bg-zinc-100 border border-black rounded-full inline" {{#if postOwner}} src = "https://media.tenor.com/BEBopBnhjVEAAAAi/peach-and-goma-peach-goma.gif" {{else}} src = "https://i.pinimg.com/originals/6f/65/78/6f65784caf4dd9f9932de464788dde43.jpg"{{/if}}>
                        <button class="userLink text-base font-medium inline underline decoration-1" id = {{uid}}>{{user}}</button>
                        <p class="text-xs font-extralight inline">{{date}}</p>
                    {{else}}
                        <h1 class = "font-extralight text-sm inline">Posted by: </h1>
                        <img class="w-1/12 bg-zinc-100 border border-black rounded-full inline" {{#if postOwner}} src = "https://media.tenor.com/BEBopBnhjVEAAAAi/peach-and-goma-peach-goma.gif" {{else}} src = "https://i.pinimg.com/originals/6f/65/78/6f65784caf4dd9f9932de464788dde43.jpg"{{/if}}>
                        <button class = "userLink text-base font-medium inline underline italic" id = {{uid}}>Anon </button>
                        <p class="text-xs font-extralight inline">{{date}}</p>
                    {{/if}}
                        
                    <p class = "mt-3 text-base font-medium">{{post}}</p>
                </div>
                <button class="font-extralight text-sm hover:bg-gray-200 inline"> <i class="inline fa-regular fa-comments"></i> {{replyCount}} Comments</button>

                {{#if (getUserState)}}
                    <!-- <button class = "interact font-extralight text-sm hover:bg-gray-200"><i class="fa-regular fa-share-from-square"></i> Share </button> -->
                    <button id = {{id}} class = "interact font-extralight text-sm hover:bg-gray-200" onclick="pinPost(this)"><i class="fa-regular fa-bookmark {{#if isPinned}} bg-blue-500{{/if}}"></i> Pin </button>
                {{/if}}
            </div>
            {{/if}}
        {{/each}}
    </script>

    <script id="activities" type="text/x-handlebars-template">
        <div class = "flex flex-col p-3 w-full">
            {{#if data}}
                {{#each data}}
                    {{#if post}}
                        <div class="text-sm post-item shadow-md border rounded border-gray-200 mb-1 px-5 pb-1 pt-3 {{#if postOwner}} bg-blue-300{{else}} bg-cyan-50{{/if}} hover:scale-105 cursor-pointer transition break-words overflow-hidden" id="{{id}}">
                            <p class="mb-2">{{post}}</p>
                            {{#if user}}
                                <h1 class="text-xs inline">By: </h1><h1 class="text-sm font-semibold inline">{{user}}</h1>
                            {{else}}
                                <h1 class="text-xs inline">By: </h1><h1 class="text-sm font-semibold inline-block italic">Anon</h1>
                            {{/if}}
                            <p class="text-xs mb-2">{{date}}</p>
                        </div>
                    {{/if}}
                {{/each}}
            {{else}}
                <p class = "text-sm mt-10 text-center">Nothing here yet... Go make your first post.</p>
                <img class = "w-1/2 mx-auto"src="https://media.tenor.com/j2QJ3XFBh-8AAAAi/give-me-that-reaching.gif" alt="">
            {{/if}}
        </div>
    </script>
    
    <script id = "postFocus" type = "text/x-handlebars-template">
        <div class = "text-sm bg-white shadow-md rounded bg-white shadow-md rounded px-9 pr-10 pt-8 pb-8 break-words z-45">
            <button class = "transition hover:scale-125 absolute top-3 right-4" onclick="closePostFocus()">
                <i class="fa-solid fa-xmark text-2xl" style="color: #e60000;"></i>
            </button>

            <div class="p-2 border rounded border-slate-100 bg-white relative" id = {{data.id}}>
                <p class="text-base mb-3">{{data.post}}</p>
                {{#if data.user}}
                    <h1 class="font-extralight text-sm inline">Posted by:</h1>
                    <img class="w-1/12 bg-zinc-100 border border-black rounded-full inline" {{#if data.postOwner}} src = "https://media.tenor.com/BEBopBnhjVEAAAAi/peach-and-goma-peach-goma.gif" {{else}} src = "https://i.pinimg.com/originals/6f/65/78/6f65784caf4dd9f9932de464788dde43.jpg"{{/if}}>
                    <button class="userLink text-base font-medium inline underline decoration-1" id = {{data.uid}}>{{data.user}}</button>
                {{else}}
                    <h1 class="font-extralight text-sm inline">Posted by:</h1>
                    <img class="w-1/12 bg-zinc-100 border border-black rounded-full inline" {{#if data.postOwner}} src = "https://media.tenor.com/BEBopBnhjVEAAAAi/peach-and-goma-peach-goma.gif" {{else}} src = "https://i.pinimg.com/originals/6f/65/78/6f65784caf4dd9f9932de464788dde43.jpg"{{/if}}>
                    <button class="userLink text-base font-medium inline underline decoration-1 italic" id = {{data.uid}}>Anon</button>
                {{/if}}

                <p class="text-xs mb-2">{{data.date}}</p>
                {{#if data.postOwner }}
                    <button onclick="deletePost('{{data.id}}')" class="text-2xl text-red-500 float-right absolute top-3 right-5 hover:scale-125 transition">
                        <i class="fa-solid fa-trash-can"></i>
                    </button>
                {{/if}}
            </div>

            {{#if (getUserState)}}
                <label class="mt-2 block text-xs font-medium text-gray-900" for="message">Comment as {{getUsername}}</label>
                <textarea class="mt-2 block text-xs p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 min-h-[50px] max-h-[500px] resize-y" id="replyMessage" placeholder="ex... batia pod sa imong post oi delete ko ni ron"></textarea>
                <button class="mt-2 py-2 px-4 text-xs text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120 ml-auto" onclick="replyPost('{{data.id}}')">Comment</button>           
            {{/if}}

            {{#if data.reply}}
            <div class="relative max-h-56 overflow-y-auto mt-4">
                {{#each data.reply}}
                    {{#if reply}}
                        <div class="relative p-2 text-sm mb-2 border-l border-black break-words {{#if replyOwner}} bg-blue-300 {{else}}bg-zinc-50{{/if}}">
                            <p class="text-base mb-3">{{reply}}</p>
                            {{#if user}}
                                <img class="w-1/12 bg-zinc-100 border border-black rounded-full inline" {{#if replyOwner}} src = "https://media.tenor.com/BEBopBnhjVEAAAAi/peach-and-goma-peach-goma.gif" {{else}} src = "https://i.pinimg.com/originals/6f/65/78/6f65784caf4dd9f9932de464788dde43.jpg"{{/if}}>
                                <button class="userLink text-base font-medium inline underline decoration-1" id = {{uid}}>{{user}}</button> {{#if postOP}}<p class = "font-black text-blue-900 inline">OP</p>{{/if}}
                            {{else}}
                                <img class="w-1/12 bg-zinc-100 border border-black rounded-full inline" {{#if replyOwner}} src = "https://media.tenor.com/BEBopBnhjVEAAAAi/peach-and-goma-peach-goma.gif" {{else}} src = "https://i.pinimg.com/originals/6f/65/78/6f65784caf4dd9f9932de464788dde43.jpg"{{/if}}>
                                <button class="userLink text-base font-medium inline underline decoration-1 italic" id = {{uid}}>Anon</button> {{#if postOP}}<p class = "font-black text-blue-900 inline">OP</p>{{/if}}
                            {{/if}}
                            <p class="text-xs inline">{{date}}</p>
                            {{#if replyOwner}}
                                <button onclick="deletePostReply('{{id}}')" class="text-base float-right absolute top-3 right-3 hover:text-red-600 hover:scale-105 transition">
                                    <i class="fa-solid fa-trash-can"></i>
                                </button>
                            {{/if}}
                        </div>
                    {{/if}}
                {{/each}}
            </div>
            {{/if}}
        </div>
    </script>

    <script id = "userProfile" type = "text/x-handlebars-template">
        

        <div class = "w-full grid grid-cols-10 gap-0 px-10">
            <div class = "col-span-4 w-full">
                <div id = "userProfileFocusContainer" class = "max-w-lg left-[5%] top-[25%] postFocusContainer fixed"></div>
            </div>
                
            <div class = "col-span-4 flex flex-col max-w-lg">
                <div class = "mb-5 w-full flex flex-row gap-5 justify-around items-start">
                    <button class = "text-xl font-bold">Activity</button>
                    <button class = "text-xl font-bold">Posts</button>
                    <button class = "text-xl font-bold">Comments</button>
                    {{#if isMainUser}}
                        <button class = "text-xl font-bold">Pins</button> 
                    {{/if}}
                </div>

                <div id = "userContentContainer" class = "h-full overflow-x-hidden overflow-y-auto flex flex-col gap-2 posts-container"></div> 
            </div>

            <div class = "flex flex-col col-span-2 w-full gap-3">
                <div class = "bg-white border border-gray-200 rounded-lg shadow px-4 py-4 relative">
                    {{#if isMainUser}}
                        <img class = "inline-block w-1/6 bg-zinc-100 border border-black rounded-full" src="https://media.tenor.com/BEBopBnhjVEAAAAi/peach-and-goma-peach-goma.gif" alt="">
                    {{else}}
                        <img class = "inline w-1/6 bg-zinc-100 border border-black rounded-full" src="https://i.pinimg.com/originals/6f/65/78/6f65784caf4dd9f9932de464788dde43.jpg" alt="">
                    {{/if}}
                    <h1 class = "text-lg font-bold">
                        {{#if username}}
                            {{username}}
                        {{else}}
                            <p class = "italic">Anon</p>
                        {{/if}}
                    </h1>
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Laboriosam hic quaerat nihil porro nemo, debitis officiis quas consequatur ad illum.</p>
                    <button class="text-base float-right px-4 py-2 border rounded text-white bg-blue-500 hover:text-blue-500 hover:bg-white hover:border-blue-500 transition">Follow</button>
                </div>
                <div class = "text-center bg-white border border-gray-200 rounded-lg shadow px-4 py-4 relative">
                    <q class = "bg-gray-300 px-3 py-1 rounded">I am cat</q>
                </div>
                <div class = "bg-white border border-gray-200 rounded-lg shadow px-4 py-4 relative gap-2">
                    <p class = "font-semibold">Trophies</p>

                    <div class = "flex flex-row items-center">
                        <img width="40" height="40" src="https://img.icons8.com/bubbles/50/verified-account.png" alt="verified-account"/>
                        <p>Verified</p>
                    </div>

                    <div class = "flex flex-row items-center">
                        <img width="40" height="40" src="https://img.icons8.com/plasticine/100/grass.png" alt="grass"/>
                        <p>Touch Grass</p>
                    </div>

                    <div class = "flex flex-row items-center">
                        <img width="40" height="40" src="https://img.icons8.com/glyph-neue/64/cat-lying.png" alt="cat-lying"/>
                        <p>Cat Club</p>
                    </div>

                    

                </div>
            </div>
        </div>
    </script> 

</head>

<body class = "bg-[#E3F2F1]">
    <header class = "fixed top-0 w-full z-20 flex items-center justify-between p-4 bg-cyan-300 border-b-[#6E7291] shadow-md">
        <div class="flex items-center">
            <div class = "flex items-end">
                <img class = "w-1/6 h-full" src="https://media.tenor.com/lqtU1G4aaqIAAAAi/yom-dance.gif" alt="">
                <a class="inline" href="index.html">
                    <h1 class="text-4xl font-black text-[#3F3F46] underline">CaTalk Forum</h1>
                </a>
            </div>
        </div>
        <div class = "flex items-center gap-3">
            <div class="flex flex-row items-center">
                <div class="relative">
                  <input class="w-full text-black shadow appearance-none border rounded py-2 px-3 leading-tight focus:outline-none focus:shadow-outline" type="text" id="searchInput" placeholder="Search posts">
                    <i class="fa-solid fa-magnifying-glass text-blue-500 absolute top-1/2 transform -translate-y-1/2 right-4 cursor-pointer"></i>
                </div>
              </div>
            <button class = "hidden py-2 px-4 text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120 ml-auto" id = "createPostBtn">Create Post</button>
            <button class = "hidden py-2 px-4 text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120 ml-auto" id = "signOutBtn">Sign Out</button>
            <button class = "hidden py-2 px-4 text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120 gap-3" id = "loginBtn">Login</button>
            <button class = "hidden py-2 px-4 text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120 gap-3" id = "registerBtn">Register</button>

            <input class = "hidden" type="checkbox"  id = "sidebar-checkbox">
            <button class="text-4xl" id = "sidebar-button">
                <i class="fa-solid fa-user text-blue-500 border-white hover:text-white hover:border-blue-500 hover:transition-all transition ease-in-out delay-120 ml-auto"></i>
            </button>
        </div>
    </header>

    <main class="flex flex-col w-full gap-3 mt-40 justify-center items-start">
        <div class = "flex flex-row justify-center gap-2 w-full">
            <div id="posts-container" class="posts-container flex flex-col gap-2 max-w-lg overflow-x-hidden h-full overflow-y-auto"></div>

            <div class = "w-96">
                <div id = "mainPostFocusContainer" class = "fixed max-h-64 max-w-[43%] postFocusContainer"></div>
            </div>
        </div>
    </main>
      
    <button id = "backToTop" onclick = "backToTop()" class = "fixed hidden bottom-5 right-5 rounded-full bg-black text-white p-4 cursor-pointer z-10 transition-all"><i class="fa-solid fa-arrow-up" style = "animation: up 1.5s infinite;"></i> Back to top</button>

    <footer>
        <div class = "fixed max-w-[280px] flex flex-row items-end justify-center bottom-5 left-3 transform border-black border-b-[1px]">
            <p class = "text-base font-semibold">All rights reserved | Kuugang </p>
            <img class = "w-2/12" src="https://media.tenor.com/j_XffFNH-8gAAAAi/phone.gif" alt="">
        </div>
    </footer>

    <div id="drawer" class="fixed top-0 right-0 transform translate-x-full z-40 w-1/3 h-full transition-all duration-300 transform bg-white shadow-lg pl-4 pt-6 pb-1">
        <div class="h-full">
            <div class = "flex items-center justify-between pr-5">
                <h2 class="text-lg font-bold">Profile</h2>
                <button class = "text-sm" onclick = "editProfile()">Edit Profile <i class="fa-solid fa-pencil"></i></button>
            </div>
            <div class = "flex flex-col justify-center items-center gap-1">
                <img class = "w-3/12 bg-zinc-100 border border-black rounded-full" src="https://media.tenor.com/BEBopBnhjVEAAAAi/peach-and-goma-peach-goma.gif" alt="">
                <h1 class = "block text-lg font-semibold" id = "currentUser"></h1>
                <p class="text-gray-500">Lorem ipsum dolor sit amet consectetur adipisicing elit. Quia assumenda consequuntur excepturi, corporis optio numquam ipsum aut? Vel, dolore natus!</p>
            </div>
            <h2 class = "text-lg font-bold mt-6">My activities</h2>
            <div id = "activity" class = "overflow-x-hidden overflow-y-auto h-full">
            </div>
        </div>
    </div>


    <div id = "signOutConfirm" class = "hidden z-30 fixed bg-white px-8 py-6 border rounded shadow-md top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
        <div class = "flex flex-col items-center">
            <h1 class = "text-center text-4xl font-black">Sign out</h1>
            <img class = "w-1/3" src="https://media.tenor.com/t7yxNky6vVoAAAAi/sebusun-mocha.gif" alt="">
            <p class = "font-medium">Are you sure you would like to sign out of your account?</p>
            <div class = "flex flex-row justify-center gap-3 mt-4">
                <button id = "signoutConfirmButton" class = "py-2 px-4 text-black border rounded border-blue-500 hover:text-white hover:bg-blue-500 hover:transition-all transition ease-in-out delay-120 ">Sign out</button>
                <button id = "signoutCancelButton" class = "py-2 px-4 text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120">Cancel</button>
            </div>
        </div>
    </div>

    <form class = "createPostContainer hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 z-30 bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 w-1/2" action="" id = "newPost">
        <div class = "flex items-end">
            <label class = "mt-5 text-3xl font-medium text-gray-900" for="message">Got something to share? </label>
            <img class = "w-1/12" src="https://media.tenor.com/be0JrmqzM5oAAAAi/mochi-peach.gif" alt="">
        </div>
        <textarea class="mt-5 block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mb-6 min-h-[100px] max-h-[200px] resize-y" id = "message" placeholder="ex...Lately, I've been, I've been losing sleep Dreaming about the things that we could be But baby, I've been, I've been praying hard"></textarea>
        <button class = "py-2 px-4 text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120 float-right">Post</button>
    </form>

    <form class = "registerContainer hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 z-30 bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4" id = "register">
        <label class = "block text-black text-4xl font-bold mb-2" for="firstName">Register</label>
        <label class = "block text-gray-700 text-sm font-bold mb-2" for="firstName">Enter fist name: </label>
        <input class = "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" type="text" id = "registerFirstName">

        <label class = "block text-gray-700 text-sm font-bold mb-2" for="lastName">Enter last name: </label>
        <input class = "shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" type="text" id = "registerLastName">

        <label class = "block text-gray-700 text-sm font-bold mb-2" for="username">Enter username: </label>
        <input class = "mb-4  appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" type="text" id = "registerUserName">

        <button class = "py-2 px-4 text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120 float-right">Register</button>
    </form> 

    <form action="" class = "loginContainer hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 z-30 bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4" id = "login">
        <label class = "block text-black text-4xl font-bold mb-2" for="firstName">Login</label>
        <label class = "block text-gray-700 text-sm font-bold mb-2" for="username">Enter username: </label>
        <input class = "mb-4 appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" type="text" id = "loginUserName" val = "">
        <button class = "py-2 px-4 text-white border rounded border-blue-500 bg-blue-500 hover:text-blue-500 hover:bg-white hover:transition-all transition ease-in-out delay-120 float-right">Login</button>
    </form> 

    <div class="hidden spinner fixed z-30 top-0 left-0 w-full h-full flex justify-center items-center bg-opacity-50 bg-gray-200">
        <div class="inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]" role="status">
            <span class="!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]">Loading...</span>
        </div>
    </div>

    <div class="posts-loader absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
        <img class = "" src="https://media.tenor.com/EWB9EfXiwuEAAAAi/chill-cute.gif" alt="">
        <h1 class = "text-center text-4xl font-bold mt-4">Getting posts...</h1>
    </div>
    <div class="overlay hidden"></div>
    <script src = "index.js" defer></script>
</body>
</html>